<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Виль Андрей Владимирович International Corporation - Своя игра</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1a237e;
            --secondary-color: #3949ab;
            --accent-color: #e53935;
            --light-color: #f5f5f5;
            --dark-color: #1a237e;
            --success-color: #43a047;
            --warning-color: #fb8c00;
            --gradient-start: #1a237e;
            --gradient-end: #3949ab;
        }

        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--light-color), #e3f2fd);
            color: var(--dark-color);
            min-block-size: 100vh;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            max-inline-size: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .game-board-header {
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            color: white;
            text-align: center;
            padding: 20px;
            border-radius: 12px;
            font-weight: bold;
            min-block-size: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }

        .game-board-header:hover {
            transform: translateY(-5px);
        }

        .question-cell {
            background: linear-gradient(135deg, var(--secondary-color), #5c6bc0);
            color: white;
            text-align: center;
            padding: 25px;
            border-radius: 12px;
            font-weight: bold;
            min-block-size: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            font-size: 1.2em;
        }

        .question-cell:hover {
            transform: scale(1.05);
            background: linear-gradient(135deg, #5c6bc0, var(--secondary-color));
        }

        .question-cell.disabled {
            background: linear-gradient(135deg, #9e9e9e, #757575);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .modal {
            display: none;
            position: fixed;
            inset-block-start: 0;
            inset-inline-start: 0;
            inset-inline-end: 0;
            inset-block-end: 0;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow-y: auto;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 50px auto;
            padding: 30px;
            border-radius: 15px;
            max-inline-size: 800px;
            position: relative;
            animation: fadeIn 0.3s ease-out;
        }

        .team-btn {
            margin: 5px;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .button {
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            outline: none;
        }

        .button-primary {
            background: linear-gradient(135deg, var(--secondary-color), #5c6bc0);
            color: white;
        }

        .button-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .button-danger {
            background: linear-gradient(135deg, var(--accent-color), #ef5350);
            color: white;
        }

        .button-success {
            background: linear-gradient(135deg, var(--success-color), #66bb6a);
            color: white;
        }

        .button-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .button-info {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .button:active {
            transform: translateY(0);
        }

        .header {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            color: white;
            border-radius: 20px;
            margin-block-end: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            inset-block-start: 0;
            inset-inline-start: 0;
            inset-inline-end: 0;
            inset-block-end: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1), transparent);
            z-index: 1;
        }

        .score-board {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }

        .score-card {
            padding: 20px;
            border-radius: 15px;
            background: linear-gradient(135deg, white, #f5f5f5);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            min-inline-size: 180px;
            text-align: center;
            transition: transform 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .score-card:hover {
            transform: translateY(-5px);
        }

        .podium {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            margin: 40px 0;
            block-size: 300px;
            gap: 48px;
        }

        .podium-step {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            inline-size: 160px;
            block-size: 100%;
            min-block-size: 150px;
            padding: 32px 10px 24px 10px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(44, 62, 80, 0.10);
            border-radius: 10px 10px 0 0;
        }

        .podium-step-1 {
            block-size: 250px;
            background: linear-gradient(135deg, #ffd700, #ffc107);
            border-radius: 10px 10px 0 0;
            z-index: 3;
            animation-delay: 0.3s;
        }

        .podium-step-2 {
            block-size: 200px;
            background: linear-gradient(135deg, #c0c0c0, #9e9e9e);
            border-radius: 10px 10px 0 0;
            z-index: 2;
            animation-delay: 0.6s;
        }

        .podium-step-3 {
            block-size: 150px;
            background: linear-gradient(135deg, #cd7f32, #8d6e63);
            border-radius: 10px 10px 0 0;
            z-index: 1;
            animation-delay: 0.9s;
        }
        
        .team-avatar {
            inline-size: 56px;
            block-size: 56px;
            background: linear-gradient(135deg, var(--secondary-color), #5c6bc0);
            border-radius: 50%;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 22px;
            margin-block-start: -28px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border: 4px solid white;
        }

        .team-select-modal {
            display: none;
            position: fixed;
            inset-block-start: 0;
            inset-inline-start: 0;
            inset-inline-end: 0;
            inset-block-end: 0;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
        }

        .team-select-content {
            background-color: white;
            margin: 50px auto;
            padding: 30px;
            border-radius: 15px;
            max-inline-size: 600px;
            text-align: center;
        }

        .team-select-btn {
            background: linear-gradient(135deg, var(--secondary-color), #5c6bc0);
            color: white;
            padding: 15px 30px;
            margin: 10px 0;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .team-select-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Стили для списка команд */
        #teams-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        #teams-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-block-end: 1px solid #e3e3e3;
            font-size: 1.1em;
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #222a4d;
        }
        #teams-list li:last-child {
            border-block-end: none;
        }
        #teams-list .text-red-500 {
            margin-inline-start: 10px;
        }
        .header, h1, h2, h3, h4, h5, h6, label, button {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* Анимированный размытый фон */
        .animated-bg {
            position: fixed;
            inset: 0;
            inline-size: 100vw;
            block-size: 100vh;
            z-index: 0;
            overflow: hidden;
            pointer-events: none;
        }
        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(40px);
            opacity: 0.55;
            mix-blend-mode: lighten;
            /* Временно для проверки движения */
            outline: 2px dashed #fff3;
        }
        .blob1 {
            inline-size: 520px;
            block-size: 520px;
            background: radial-gradient(circle at 30% 30%, #4f5bd5 60%, #fc466b 100%);
            inset-block-start: 5vh;
            inset-inline-start: 5vw;
            animation: blobMove1 18s linear infinite alternate;
        }
        .blob2 {
            inline-size: 420px;
            block-size: 420px;
            background: radial-gradient(circle at 70% 70%, #43e97b 60%, #38f9d7 100%);
            inset-block-start: 60vh;
            inset-inline-start: 60vw;
            animation: blobMove2 22s linear infinite alternate;
        }
        .blob3 {
            inline-size: 400px;
            block-size: 400px;
            background: radial-gradient(circle at 60% 40%, #a259c6 60%, #fbc2eb 100%);
            inset-block-start: 40vh;
            inset-inline-start: 10vw;
            animation: blobMove3 20s linear infinite alternate;
        }
        .blob4 {
            inline-size: 340px;
            block-size: 340px;
            background: radial-gradient(circle at 80% 20%, #fad0c4 60%, #ff61a6 100%);
            inset-block-start: 10vh;
            inset-inline-start: 75vw;
            animation: blobMove4 26s linear infinite alternate;
        }
        @keyframes blobMove1 {
            0%   { transform: translate(0, 0) scale(1); }
            25%  { transform: translate(180px, 120px) scale(1.08); }
            50%  { transform: translate(320px, 0) scale(0.95); }
            75%  { transform: translate(180px, -120px) scale(1.05); }
            100% { transform: translate(0, 0) scale(1); }
        }
        @keyframes blobMove2 {
            0%   { transform: translate(0, 0) scale(1); }
            20%  { transform: translate(-120px, -180px) scale(1.1); }
            50%  { transform: translate(-320px, 0) scale(0.92); }
            80%  { transform: translate(-120px, 180px) scale(1.04); }
            100% { transform: translate(0, 0) scale(1); }
        }
        @keyframes blobMove3 {
            0%   { transform: translate(0, 0) scale(1); }
            30%  { transform: translate(200px, 80px) scale(1.07); }
            60%  { transform: translate(0, 200px) scale(0.97); }
            90%  { transform: translate(-160px, 0) scale(1.03); }
            100% { transform: translate(0, 0) scale(1); }
        }
        @keyframes blobMove4 {
            0%   { transform: translate(0, 0) scale(1); }
            40%  { transform: translate(-160px, 160px) scale(1.09); }
            70%  { transform: translate(-320px, -80px) scale(0.93); }
            100% { transform: translate(0, 0) scale(1); }
        }

        #team-select-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        /* Анимация для правильного и неправильного ответа */
        @keyframes answer-correct-anim {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes answer-wrong-anim {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
            100% { transform: translateX(0); }
        }

        .answer-correct-anim {
            animation: answer-correct-anim 0.5s ease;
        }

        .answer-wrong-anim {
            animation: answer-wrong-anim 0.5s ease;
        }

        /* Анимация для подсказки */
        .hint-anim {
            animation: hintFadeIn 0.7s cubic-bezier(.4,2,.3,1);
        }
        @keyframes hintFadeIn {
            0% {
                opacity: 0;
                transform: scale(0.92);
                box-shadow: 0 0 0 0 rgba(255, 235, 59, 0.0);
            }
            60% {
                opacity: 1;
                transform: scale(1.04);
                box-shadow: 0 0 24px 8px rgba(255, 235, 59, 0.18);
            }
            100% {
                opacity: 1;
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 235, 59, 0.0);
            }
        }

        .vodonos-signature {
            font-size: 0.95em;
            color: #e0e7ff;
            opacity: 0.85;
            font-weight: 400;
            margin-block-end: 8px;
        }

        /* Анимация для кнопки 'Показать ответ' */
        .show-answer-anim {
            animation: showAnswerPulse 0.7s cubic-bezier(.4,2,.3,1);
        }
        @keyframes showAnswerPulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(33, 40, 100, 0.0);
            }
            40% {
                transform: scale(1.12);
                box-shadow: 0 0 24px 8px rgba(33, 40, 100, 0.18);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(33, 40, 100, 0.0);
            }
        }

        /* Анимация bounce и свечение для 1 места */
        .podium-step-1.animated-winner {
            animation: winnerBounce 1.2s cubic-bezier(.4,2,.3,1) 1.2s 2 alternate;
            box-shadow: 0 0 32px 8px #ffe082, 0 0 0 0 #ffd700;
        }
        @keyframes winnerBounce {
            0% { transform: translateY(0) scale(1); box-shadow: 0 0 32px 8px #ffe082, 0 0 0 0 #ffd700; }
            30% { transform: translateY(-18px) scale(1.08); box-shadow: 0 0 48px 16px #ffd700, 0 0 0 0 #ffd700; }
            60% { transform: translateY(0) scale(1); box-shadow: 0 0 32px 8px #ffe082, 0 0 0 0 #ffd700; }
            100% { transform: translateY(0) scale(1); box-shadow: 0 0 32px 8px #ffe082, 0 0 0 0 #ffd700; }
        }

        /* Конфетти */
        .confetti-container {
            pointer-events: none;
            position: fixed;
            inset-inline-start: 0; inset-block-start: 0; inline-size: 100vw; block-size: 100vh;
            z-index: 2000;
        }
        .confetti {
            position: absolute;
            inline-size: 12px; block-size: 18px;
            border-radius: 3px;
            opacity: 0.85;
            animation: confetti-fall 2.8s linear forwards;
        }
        @keyframes confetti-fall {
            0% { opacity: 0.85; transform: translateY(-40px) rotate(0deg) scale(1); }
            80% { opacity: 1; }
            100% { opacity: 0.7; transform: translateY(100vh) rotate(360deg) scale(1.1); }
        }

        /* Стили для надписей на пьедестале */
        .podium-step .podium-team-name {
            font-size: 1.25em;
            font-weight: 700;
            color: #222a4d;
            text-shadow: 0 2px 8px #fff;
            margin-block-end: 0.2em;
            text-align: center;
            word-break: break-word;
            white-space: normal;
            line-height: 1.2;
            max-inline-size: 100%;
        }
        .podium-step .podium-team-score {
            font-size: 1.5em;
            font-weight: 800;
            color: #222a4d;
            text-shadow: 0 2px 8px #fff;
            margin-block-end: 0.5em;
            text-align: center;
        }

        @media (max-inline-size: 600px) {
            .header {
                padding: 16px;
                font-size: 1.1em;
                margin-block-end: 18px;
            }
            .game-board {
                inline-size: 100vw !important;
                max-inline-size: 100vw !important;
                min-inline-size: 0 !important;
                margin: 0 !important;
                padding: 0 !important;
                border-radius: 0 !important;
                box-shadow: none !important;
                background: transparent !important;
                box-sizing: border-box !important;
                overflow-x: auto !important;
            }
            .game-board-header {
                font-size: 1em;
                padding: 10px;
                min-block-size: 48px;
            }
            .question-cell {
                font-size: 1em;
                padding: 12px;
                min-block-size: 48px;
            }
            .score-board {
                gap: 8px;
                margin: 10px 0;
            }
            .score-card {
                padding: 10px;
                min-inline-size: 110px;
                font-size: 0.95em;
            }
            .podium {
                gap: 10px;
                margin: 18px 0;
                block-size: 120px;
                block-size: 120px;
            }
            .podium-step {
                inline-size: 70px;
                min-block-size: 60px;
                padding: 10px 2px 8px 2px;
                font-size: 0.95em;
            }
            .podium-step-1 {
                block-size: 90px;
            }
            .podium-step-2 {
                block-size: 70px;
            }
            .podium-step-3 {
                block-size: 55px;
            }
            .podium-step .podium-team-name {
                font-size: 0.95em;
                margin-block-end: 0.1em;
                padding: 0 2px;
            }
            .podium-step .podium-team-score {
                font-size: 1.1em;
                margin-block-end: 0.2em;
            }
            .podium > .flex {
                margin: 0 2px;
            }
            .text-xl, .text-2xl, .text-3xl, .text-4xl {
                font-size: 1.1em !important;
            }
            .bg-white.p-8.rounded-lg.shadow-lg.max-w-4xl.mx-auto.mb-8 {
                padding: 10px !important;
                max-inline-size: 100vw !important;
            }
            table.w-full.table-auto {
                display: block;
                overflow-x: auto;
                inline-size: 100%;
            }
            table.w-full.table-auto thead, table.w-full.table-auto tbody, table.w-full.table-auto tr {
                display: table;
                inline-size: 100%;
                table-layout: fixed;
            }
            table.w-full.table-auto th, table.w-full.table-auto td {
                font-size: 0.95em;
                padding: 6px 4px;
                word-break: break-word;
            }
            .button, .button-primary, .button-danger, .button-success {
                font-size: 1em;
                padding: 8px 12px;
            }
            .modal-content {
                padding: 12px;
                max-inline-size: 98vw;
            }
        }

        @media (max-inline-size: 500px) {
          .header {
            padding: 10px;
            font-size: 1em;
            margin-block-end: 10px;
            border-radius: 10px;
          }
          .game-board {
            grid-template-columns: 1fr !important;
            gap: 6px !important;
            padding: 0 !important;
            inline-size: 100vw !important;
            max-inline-size: 100vw !important;
            min-inline-size: 0 !important;
            margin: 0 !important;
            border-radius: 0 !important;
            box-shadow: none !important;
            background: transparent !important;
            box-sizing: border-box !important;
            overflow-x: auto !important;
          }
          .game-board-header {
            font-size: 0.95em;
            padding: 8px;
            min-block-size: 36px;
            border-radius: 8px;
          }
          .question-cell {
            font-size: 1em;
            padding: 10px;
            min-block-size: 36px;
            border-radius: 8px;
          }
          .score-board {
            gap: 6px;
            margin: 6px 0;
            flex-direction: column !important;
            align-items: center !important;
          }
          .score-card {
            padding: 8px;
            min-inline-size: 90px;
            font-size: 0.9em;
            border-radius: 8px;
          }
          .podium {
            gap: 4px;
            margin: 10px 0;
            block-size: 60px;
            block-size: 60px;
          }
          .podium-step {
            inline-size: 36px;
            min-block-size: 24px;
            padding: 4px 1px 4px 1px;
            font-size: 0.8em;
            border-radius: 6px 6px 0 0;
          }
          .podium-step-1 { block-size: 32px; }
          .podium-step-2 { block-size: 24px; }
          .podium-step-3 { block-size: 18px; }
          .podium-step .podium-team-name {
            font-size: 0.8em;
            margin-block-end: 0.05em;
            padding: 0 1px;
          }
          .podium-step .podium-team-score {
            font-size: 0.95em;
            margin-block-end: 0.1em;
          }
          .podium > .flex {
            margin: 0 1px;
          }
          .text-xl, .text-2xl, .text-3xl, .text-4xl {
            font-size: 1em !important;
          }
          .bg-white.p-8.rounded-lg.shadow-lg.max-w-4xl.mx-auto.mb-8 {
            padding: 4px !important;
            max-inline-size: 100vw !important;
            border-radius: 8px !important;
          }
          table.w-full.table-auto {
            display: block;
            overflow-x: auto;
            inline-size: 100%;
          }
          table.w-full.table-auto thead, table.w-full.table-auto tbody, table.w-full.table-auto tr {
            display: table;
            inline-size: 100%;
            table-layout: fixed;
          }
          table.w-full.table-auto th, table.w-full.table-auto td {
            font-size: 0.9em;
            padding: 4px 2px;
            word-break: break-word;
          }
          .button, .button-primary, .button-danger, .button-success {
            font-size: 0.95em;
            padding: 6px 8px;
            border-radius: 8px;
          }
          .modal-content {
            padding: 6px;
            max-inline-size: 99vw;
            border-radius: 8px;
          }
          .container {
            padding: 2px !important;
          }
        }

        /* Стили для вариантов ответов */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-block-start: 20px;
        }

        .option-button {
            padding: 15px;
            border-radius: 10px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
            text-align: start;
            color: #1e293b;
            font-weight: 500;
            cursor: pointer;
        }

        .option-button:hover:not(:disabled) {
            background: #e0e7ff;
            border-color: #c7d2fe;
            transform: translateY(-2px);
        }

        .option-button:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        @media (max-inline-size: 600px) {
            .modal-content {
                margin: 20px;
                padding: 20px;
            }

            .option-button {
                padding: 12px;
                font-size: 0.95em;
            }

            .button {
                padding: 8px 16px;
                font-size: 0.9em;
            }
        }

        /* Анимации для правильного и неправильного ответов */
        @keyframes correctAnswer {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        @keyframes wrongAnswer {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }

        .answer-correct-anim {
            animation: correctAnswer 0.5s ease;
        }

        .answer-wrong-anim {
            animation: wrongAnswer 0.5s ease;
        }

        /* Стили для модального окна с вопросом */
        #question-modal .modal-content {
            max-inline-size: 480px;
            inline-size: 95%;
            padding: 28px 18px 24px 18px;
        }

        #question-category {
            font-size: 1em;
            color: #2563eb;
            font-weight: 600;
        }

        #question-value {
            font-size: 1em;
            color: #334155;
            font-weight: 700;
        }

        #question-text {
            font-size: 1.25em;
            font-weight: 700;
            margin-block-end: 24px;
            color: #1e293b;
            text-align: start;
        }

        .options-container {
            margin-block-start: 0;
            margin-block-end: 0;
            gap: 14px;
        }

        .option-button {
            font-size: 1.08em;
            padding: 14px 12px;
            margin-block-end: 0;
            border-radius: 10px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            transition: all 0.2s;
            text-align: start;
            color: #1e293b;
            font-weight: 500;
        }

        .option-button:hover:not(:disabled) {
            background: #e0e7ef;
            box-shadow: 0 2px 8px #dbeafe44;
        }

        @media (max-inline-size: 600px) {
            #question-modal .modal-content {
                padding: 12px 4px 16px 4px;
            }
            #question-text {
                font-size: 1.08em;
            }
            .option-button {
                font-size: 1em;
                padding: 10px 8px;
            }
        }

        /* В стилях */
        #hint-text {
            margin-block-start: 24px;
            margin-block-end: 8px;
            font-size: 1.08em;
            line-height: 1.4;
        }

        /* Новый красивый салют */
        .firework-container {
            position: fixed;
            inset-block-start: 0;
            inline-size: 120px;
            block-size: 100vh;
            pointer-events: none;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .firework-left { inset-inline-start: 0; }
        .firework-right { inset-inline-end: 0; }
        .firework-burst {
            position: absolute;
            inset-inline-start: 50%;
            inset-block-start: 50%;
            transform: translate(-50%, -50%);
            inline-size: 1px;
            block-size: 1px;
            pointer-events: none;
        }
        .firework-particle {
            position: absolute;
            inline-size: var(--size, 12px);
            block-size: var(--size, 12px);
            border-radius: 50%;
            opacity: 0.85;
            background: var(--color, #fff);
            transform: translate(-50%, -50%) scale(0.7);
            animation: firework-particle-burst 1.1s cubic-bezier(.4,2,.3,1) forwards;
        }
        .firework-particle.line {
            border-radius: 3px;
            inline-size: 4px;
            block-size: 18px;
            background: linear-gradient(180deg, var(--color, #fff) 60%, #fff0 100%);
        }
        @keyframes firework-particle-burst {
            0% { opacity: 1; transform: translate(-50%, -50%) scale(0.7); }
            60% { opacity: 1; }
            100% {
                opacity: 0;
                transform:
                    translate(calc(-50% + var(--tx, 0px)), calc(-50% + var(--ty, 0px)))
                    scale(1.2) rotate(var(--rot, 0deg));
            }
        }
    </style>
</head>
<body>
    <div class="animated-bg" aria-hidden="true">
        <div class="blob blob1"></div>
        <div class="blob blob2"></div>
        <div class="blob blob3"></div>
        <div class="blob blob4"></div>
    </div>
    <div class="container mx-auto p-4" style="position: relative; z-index: 1;">
        <!-- Начальный экран -->
        <div id="start-screen" class="text-center">
            <div class="header glass-anim" style="animation: slideUp 0.5s;">
                <h1 class="text-4xl font-bold mb-2">Виль Андрей Владимирович International Corporation</h1>
                <div class="vodonos-signature">Водонос — Сибанов Алимбек Жоломанович</div>
                <h2 class="text-2xl">Своя игра: Викторина по основам права</h2>
            </div>
            <p class="text-lg mb-6">Добро пожаловать в интерактивную викторину по основам права в формате "Своя игра"!</p>
            <button id="start-game-btn" class="button button-primary text-lg px-8 py-4">
                Начать игру
                <i class="fas fa-play ml-2"></i>
            </button>
        </div>

        <!-- Экран добавления команд -->
        <div id="teams-screen" class="text-center" style="display: none;">
            <div class="header glass-anim">
                <h1 class="text-4xl font-bold mb-2">Виль Андрей Владимирович International Corporation</h1>
                <div class="vodonos-signature">Водонос — Сибанов Алимбек Жоломанович</div>
                <h2 class="text-2xl">Добавление команд</h2>
            </div>
            <div class="bg-white p-8 rounded-lg shadow-lg max-w-md mx-auto mb-8">
                <div class="mb-4">
                    <label for="team-name" class="block text-sm font-medium text-gray-700 mb-2">Название команды:</label>
                    <input type="text" id="team-name" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <button id="add-team-btn" class="button button-primary">Добавить команду</button>
                <div class="mt-6">
                    <h3 class="text-lg font-bold mb-2">Список команд:</h3>
                    <ul id="teams-list"></ul>
                </div>
            </div>
            <div class="mt-8">
                <button id="start-board-btn" class="button button-success text-lg px-8 py-3" disabled>
                    Начать викторину
                    <i class="fas fa-arrow-right ml-2"></i>
                </button>
            </div>
        </div>

        <!-- Игровая доска -->
        <div id="game-board-screen" style="display: none;">
            <div class="header glass-anim">
                <h1 class="text-3xl font-bold mb-2">Виль Андрей Владимирович International Corporation</h1>
                <div class="vodonos-signature">Водонос — Сибанов Алимбек Жоломанович</div>
                <h2 class="text-xl">Викторина по основам права "Своя игра"</h2>
            </div>

            <!-- Табло с баллами команд -->
            <div class="score-board" id="score-board"></div>

            <!-- Игровая доска с вопросами -->
            <div class="game-board">
                <div class="game-board-header">Гражданский кодекс</div>
                <div class="game-board-header">Семейный кодекс</div>
                <div class="game-board-header">Уголовный кодекс</div>
                <div class="game-board-header">Административный кодекс</div>
                <div class="game-board-header">Трудовой кодекс</div>

                <!-- Баллы-->
                <div class="question-cell" data-category="0" data-value="100">100</div>
                <div class="question-cell" data-category="1" data-value="100">100</div>
                <div class="question-cell" data-category="2" data-value="100">100</div>
                <div class="question-cell" data-category="3" data-value="100">100</div>
                <div class="question-cell" data-category="4" data-value="100">100</div>

                <div class="question-cell" data-category="0" data-value="200">200</div>
                <div class="question-cell" data-category="1" data-value="200">200</div>
                <div class="question-cell" data-category="2" data-value="200">200</div>
                <div class="question-cell" data-category="3" data-value="200">200</div>
                <div class="question-cell" data-category="4" data-value="200">200</div>

                <div class="question-cell" data-category="0" data-value="300">300</div>
                <div class="question-cell" data-category="1" data-value="300">300</div>
                <div class="question-cell" data-category="2" data-value="300">300</div>
                <div class="question-cell" data-category="3" data-value="300">300</div>
                <div class="question-cell" data-category="4" data-value="300">300</div>

                <div class="question-cell" data-category="0" data-value="400">400</div>
                <div class="question-cell" data-category="1" data-value="400">400</div>
                <div class="question-cell" data-category="2" data-value="400">400</div>
                <div class="question-cell" data-category="3" data-value="400">400</div>
                <div class="question-cell" data-category="4" data-value="400">400</div>

                <div class="question-cell" data-category="0" data-value="500">500</div>
                <div class="question-cell" data-category="1" data-value="500">500</div>
                <div class="question-cell" data-category="2" data-value="500">500</div>
                <div class="question-cell" data-category="3" data-value="500">500</div>
                <div class="question-cell" data-category="4" data-value="500">500</div>
            </div>
            
            <div class="text-center mt-8">
                <button id="end-game-btn" class="button button-danger text-lg px-8 py-3">
                    Завершить игру
                    <i class="fas fa-trophy ml-2"></i>
                </button>
            </div>
        </div>

        <!-- Экран с результатами -->
        <div id="results-screen" style="display: none;">
            <div class="header glass-anim">
                <h1 class="text-4xl font-bold mb-2">Виль Андрей Владимирович International Corporation</h1>
                <div class="vodonos-signature">Водонос — Сибанов Алимбек Жоломанович</div>
                <h2 class="text-2xl">Результаты викторины по основам права</h2>
            </div>

            <div class="bg-white p-8 rounded-lg shadow-lg max-w-4xl mx-auto mb-8">
                <h3 class="text-2xl font-bold text-center mb-6">Пьедестал победителей</h3>
                
                <div class="podium">
                    <div class="flex flex-col items-center mx-4">
                        <div id="podium-step-2" class="podium-step podium-step-2 flex items-end justify-center flex-col">
                            <div class="podium-team-name" id="second-place-name">-</div>
                            <div class="podium-team-score" id="second-place-score">0</div>
                        </div>
                        <div class="text-xl font-bold mt-2">2 место</div>
                    </div>

                    <div class="flex flex-col items-center mx-4">
                        <div id="podium-step-1" class="podium-step podium-step-1 flex items-end justify-center flex-col">
                            <div class="podium-team-name" id="first-place-name">-</div>
                            <div class="podium-team-score" id="first-place-score">0</div>
                        </div>
                        <div class="text-xl font-bold mt-2">1 место</div>
                    </div>

                    <div class="flex flex-col items-center mx-4">
                        <div id="podium-step-3" class="podium-step podium-step-3 flex items-end justify-center flex-col">
                            <div class="podium-team-name" id="third-place-name">-</div>
                            <div class="podium-team-score" id="third-place-score">0</div>
                        </div>
                        <div class="text-xl font-bold mt-2">3 место</div>
                    </div>
                </div>

                <h3 class="text-xl font-bold mt-10 mb-4">Полный список результатов:</h3>
                <table class="w-full table-auto">
                    <thead>
                        <tr>
                            <th class="px-4 py-2 text-left">Место</th>
                            <th class="px-4 py-2 text-left">Команда</th>
                            <th class="px-4 py-2 text-right">Баллы</th>
                        </tr>
                    </thead>
                    <tbody id="results-table">
                    </tbody>
                </table>
            </div>

            <div class="text-center mt-8">
                <!-- Кнопка 'Новая игра' удалена -->
            </div>
        </div>
    </div>

    <!-- Модальное окно с вопросом -->
    <div id="question-modal" class="modal">
        <div class="modal-content">
            <div class="flex flex-col">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-blue-700 font-semibold" id="question-category"></span>
                    <span class="text-gray-700 font-bold" id="question-value"></span>
                </div>
                <div id="question-text" class="text-xl font-bold mb-6"></div>
                <div id="current-team-name" class="text-lg font-semibold mb-4"></div>
                <div id="answer-section" class="mb-4" style="display: none;">
                    <div class="text-green-600 font-semibold">Правильный ответ:</div>
                    <div id="answer-text" class="mt-2"></div>
                </div>
                <div id="options-placeholder"></div>
                <div class="flex flex-col items-center mt-6">
                    <div id="hint-text" class="text-yellow-600 mb-4" style="display: none; margin-block-start: 16px;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно выбора команды для передачи вопроса -->
    <div id="pass-question-modal" class="modal">
        <div class="modal-content">
            <h3 class="text-xl font-bold mb-4">Передать вопрос другой команде</h3>
            <p class="mb-4">Выберите команду, которой хотите передать вопрос:</p>
            <div id="pass-teams-container" class="flex flex-wrap justify-center gap-3 mb-6">
                <!-- Сюда будут добавлены кнопки команд -->
            </div>
            <div class="text-center">
                <button id="cancel-pass-btn" class="button button-danger">Отмена</button>
            </div>
        </div>
    </div>

    <!-- Модальное окно выбора команды -->
    <div id="team-select-modal" class="team-select-modal">
        <div class="team-select-content">
            <h2 class="text-2xl font-bold mb-4">Выберите команду, которая будет отвечать</h2>
            <div id="team-select-buttons"></div>
        </div>
    </div>

    <div class="confetti-container" id="confetti"></div>
    <div id="firework-left" class="firework-container firework-left"></div>
    <div id="firework-right" class="firework-container firework-right"></div>

    <script>
        // База данных вопросов
        const questions = [
            // Гражданский кодекс
            [
                {
                    value: 100,
                    question: "Что понимается под «объектами гражданских прав»?",
                    hint: "Посмотрите, какие виды имущества и невещных благ упоминаются в начале раздела о вещных правах.",
                    options: [
                        "Лица, участвующие в правоотношении (физические или юридические).",
                        "Нормы права, регулирующие имущественные отношения.",
                        "Вещи (движимые и недвижимые), деньги, ценные бумаги, результаты интеллектуальной деятельности и иные нематериальные блага.",
                        "Государственные органы, обеспечивающие защиту прав."
                    ],
                    correctAnswer: 2
                },
                {
                    value: 200,
                    question: "В чём состоит отличие «ущерба» от «упущенной выгоды» при возмещении вреда?",
                    hint: "Вред может быть реальным (фактические потери) и потенциальным (недополученный доход).",
                    options: [
                        "Ущерб — это потери от утраты имущества, а упущенная выгода — это моральный вред.",
                        "Ущерб — это недополученная прибыль, а упущенная выгода — фактические расходы на восстановление.",
                        "Ущерб — фактические потери (например, ремонт), упущенная выгода — недополученный доход (например, прибыль от аренды).",
                        "Ущерб и упущенная выгода — синонимы, различий нет."
                    ],
                    correctAnswer: 2
                },
                {
                    value: 300,
                    question: "Дайте определение «обязательству» и назовите его стороны.",
                    hint: "Обязательство — основа договорных и внедоговорных правоотношений.",
                    options: [
                        "Отношение между собственником и третьими лицами по поводу имущества.",
                        "Правоотношение, где одна сторона (должник) обязана совершить действие в пользу другой (кредитора).",
                        "Соглашение между несколькими лицами о совместной деятельности.",
                        "Отношение между государством и физическим лицом по уплате налогов."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 400,
                    question: "Что такое «правоотношение» и из каких элементов оно состоит?",
                    hint: "Правоотношение связывает субъекта, объект и содержание (права и обязанности).",
                    options: [
                        "Социальное взаимодействие, регулируемое моральными нормами.",
                        "Формальная процедура применения норм права к конкретному случаю.",
                        "Урегулированное нормами права общественное отношение, состоящее из субъекта, объекта и содержания.",
                        "Совокупность норм, закрепляющих права и обязанности."
                    ],
                    correctAnswer: 2
                },
                {
                    value: 500,
                    question: "Назовите и охарактеризуйте три способа защиты гражданских прав.",
                    hint: "Один – судебный иск, другой – досудебная претензия, третий – специальные меры.",
                    options: [
                        "Судебный (исковое заявление), административный (жалоба в контролирующий орган), уголовный (обращение в прокуратуру).",
                        "Судебный (исковое производство), досудебный (претензия), специальные меры (негаторный иск, реституция).",
                        "Медиация, переговоры, арбитражное разбирательство.",
                        "Обращение в Конституционный суд, подача жалобы в ЕСПЧ, публикация в СМИ."
                    ],
                    correctAnswer: 1
                }
            ],
            // Семейный кодекс
            [
                {
                    value: 100,
                    question: "С какого возраста разрешён брак без согласия родителей?",
                    hint: "Посмотрите общую норму о брачном возрасте.",
                    options: [
                        "С 16 лет при наличии уважительной причины.",
                        "С 18 лет без дополнительных условий.",
                        "С 21 года для мужчин и 18 для женщин.",
                        "С 14 лет с разрешения органов опеки."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 200,
                    question: "Назовите три обязательных условия для заключения брака.",
                    hint: "Условия прописаны в первой главе, касающейся порядка заключения брака.",
                    options: [
                        "Наличие свидетелей, медицинское обследование, регистрация в ЗАГСе.",
                        "Свободное согласие, достижение 18 лет (или 16 при наличии оснований), отсутствие препятствий.",
                        "Подписание брачного договора, подтверждение дееспособности, наличие жилья.",
                        "Гражданство РФ, регистрация по месту жительства, отсутствие судимостей."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 300,
                    question: "Какие права имеет ребёнок, рождённый вне брака?",
                    hint: "Семейный кодекс устанавливает равенство всех детей.",
                    options: [
                        "Право на имя, но не на наследование от отца.",
                        "Равные права с законнорождённым ребёнком.",
                        "Право на содержание только от матери.",
                        "Ограничение в праве на образование и медицинскую помощь."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 400,
                    question: "В чём суть принципа «супружеской верности»?",
                    hint: "Этот принцип упоминается в разделе о правах и обязанностях супругов.",
                    options: [
                        "Обязанность совместного проживания и ведения хозяйства.",
                        "Запрет на вступление в другие браки в период действующего.",
                        "Обязанность сохранять доверие и не вступать в интимные отношения с третьими лицами.",
                        "Обязанность сообщать супругу о всех личных расходах."
                    ],
                    correctAnswer: 2
                },
                {
                    value: 500,
                    question: "Опишите порядок раздела совместно нажитого имущества при разводе.",
                    hint: "Смотрите главу о расторжении брака и разделе имущества.",
                    options: [
                        "Имущество делится в зависимости от вклада каждого в семейный бюджет.",
                        "Супруги могут заключить соглашение (утверждается судом) или разделить имущество поровну через суд.",
                        "Всё имущество переходит к детям, если они достигли 14 лет.",
                        "Имущество делится только по решению органов опеки."
                    ],
                    correctAnswer: 1
                }
            ],
            // Уголовный кодекс
            [
                {
                    value: 100,
                    question: "Что означает «презумпция невиновности»?",
                    hint: "Формулировка приводится в Уголовно-процессуальном кодексе и Конституции.",
                    options: [
                        "Лицо считается виновным, если его задержали полицией.",
                        "Лицо считается невиновным, пока виновность не доказана судом.",
                        "Лицо считается виновным, если оно признало вину на допросе.",
                        "Презумпция не применяется к тяжким преступлениям."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 200,
                    question: "Назовите три вида наказаний, предусмотренных УК РФ.",
                    hint: "Перечень наказаний находится в начале главы об ответственности.",
                    options: [
                        "Лишение свободы, штраф, административный арест.",
                        "Лишение свободы, штраф, ограничение свободы.",
                        "Обязательные работы, конфискация имущества, ссылка.",
                        "Пожизненное заключение, исправительные работы, общественное порицание."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 300,
                    question: "Что понимается под «составом преступления»?",
                    hint: "Состав включает четыре элемента — ищите в статье о составе преступления.",
                    options: [
                        "Совокупность обстоятельств, подлежащих доказыванию в суде.",
                        "Четыре элемента: объект, объективная сторона, субъект, субъективная сторона.",
                        "Перечень квалифицирующих признаков преступления.",
                        "Список наказаний, применимых к данному деянию."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 400,
                    question: "В чём отличие умысла от неосторожности?",
                    hint: "Сравните волю и знание при умысле с предвидением при неосторожности.",
                    options: [
                        "Умысел — осознание последствий, неосторожность — полное их игнорирование.",
                        "Умысел — желание последствий, неосторожность — отсутствие заботы о них.",
                        "Умысел — действие из корысти, неосторожность — действие из халатности.",
                        "Умысел и неосторожность — синонимы, различий нет."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 500,
                    question: "Назовите и охарактеризуйте три вида освобождения от уголовной ответственности.",
                    hint: "Ищите в разделе об освобождении от уголовной ответственности и наказания.",
                    options: [
                        "Примирение с потерпевшим, истечение сроков давности, амнистия.",
                        "Добровольная явка с повинной, активное раскаяние, реабилитация.",
                        "Перевоспитание, малозначительность, помилование.",
                        "Отказ от преступления, явка с повинной, дача показаний против соучастников."
                    ],
                    correctAnswer: 0
                }
            ],
            // Административный кодекс
            [
                {
                    value: 100,
                    question: "Какой орган выносит постановление об административном правонарушении?",
                    hint: "Это может быть и должностное лицо (например, инспектор), и судья.",
                    options: [
                        "Только судья.",
                        "Уполномоченный орган или судья.",
                        "Прокурор.",
                        "Правительство РФ."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 200,
                    question: "Перечислите три вида административных наказаний.",
                    hint: "Смотрите главу о санкциях.",
                    options: [
                        "Лишение свободы, штраф, предупреждение.",
                        "Предупреждение, штраф, лишение специального права.",
                        "Обязательные работы, арест, изоляция.",
                        "Конфискация, дисквалификация, административное выдворение."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 300,
                    question: "Что такое объект административного правонарушения?",
                    hint: "Это общественные отношения, охраняемые административным правом.",
                    options: [
                        "Личность нарушителя.",
                        "Порядок управления, общественный порядок, безопасность движения.",
                        "Физическое или юридическое лицо.",
                        "Административный штраф."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 400,
                    question: "В чём состоят отличия предупреждения и штрафа?",
                    hint: "Один — без взыскания денег, другой — всегда с денежным взысканием.",
                    options: [
                        "Предупреждение — письменное, штраф — устное.",
                        "Предупреждение — без взыскания, штраф — с денежным взысканием.",
                        "Предупреждение — для юридических лиц, штраф — для физических.",
                        "Предупреждение — применяется к несовершеннолетним, штраф — к взрослым."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 500,
                    question: "Опишите процедуру обжалования постановления по делу об административном правонарушении.",
                    hint: "Два уровня — сначала в орган или должностное лицо, потом в суд.",
                    options: [
                        "Жалоба подаётся в течение 10 дней в орган, затем — в суд в течение 30 дней.",
                        "Жалоба подаётся в течение 10 дней в орган или суд.",
                        "Жалоба направляется только в суд в течение 5 дней.",
                        "Жалоба не предусмотрена, решение окончательно."
                    ],
                    correctAnswer: 1
                }
            ],
            // Трудовой кодекс
            [
                {
                    value: 100,
                    question: "Какие документы работник предоставляет при приёме на работу?",
                    hint: "Прописано в разделе об обязательных документах.",
                    options: [
                        "Диплом об образовании, СНИЛС, справку о доходах.",
                        "Паспорт и трудовая книжка.",
                        "Медицинская карта, военный билет, ИНН.",
                        "Заявление на имя работодателя, страховой полис."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 200,
                    question: "Что такое срочный трудовой договор?",
                    hint: "Смотрите определение в главе «Общие положения».",
                    options: [
                        "Договор, который можно расторгнуть в любой момент.",
                        "Договор, заключённый на определённый срок или до наступления события.",
                        "Договор на испытательный срок.",
                        "Договор с почасовой оплатой труда."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 300,
                    question: "Назовите три обязательных условия трудового договора.",
                    hint: "Перечислены в статье о содержании договора.",
                    options: [
                        "График работы, условия охраны труда, размер премии.",
                        "Место работы, трудовая функция, условия оплаты.",
                        "Социальные гарантии, срок испытания, обязанности работника.",
                        "Ответственность за нарушение договора, порядок увольнения, командировки."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 400,
                    question: "В каких случаях работник может расторгнуть трудовой договор без отработки?",
                    hint: "Ищите основания в разделе об увольнении по инициативе работника.",
                    options: [
                        "При переезде в другой город.",
                        "При нарушении работодателем условий договора (задержка зарплаты, опасные условия).",
                        "При уходе в отпуск по уходу за ребёнком.",
                        "При заключении нового трудового договора."
                    ],
                    correctAnswer: 1
                },
                {
                    value: 500,
                    question: "Опишите механизм привлечения к дисциплинарной ответственности и сроки давности.",
                    hint: "Смотрите раздел «Дисциплинарные взыскания».",
                    options: [
                        "Взыскание налагается в день совершения проступка, срок давности — 1 год.",
                        "Взыскание объявляется не позднее 1 месяца со дня выявления, срок давности — 6 месяцев.",
                        "Взыскание применяется только после суда, срок давности — 3 года.",
                        "Взыскание не требует оформления, срок давности — 2 года."
                    ],
                    correctAnswer: 1
                }
            ]
        ];

        // Глобальные переменные
        let teams = [];
        let currentQuestion = null;
        let currentTeamIndex = 0;
        let currentTeam = null;
        let hintUsed = false;
        let questionsAnswered = 0;
        let totalQuestions = 25; // 5 категорий * 5 вопросов
        let selectedCell = null;

        // DOM-элементы
        const startScreen = document.getElementById('start-screen');
        const teamsScreen = document.getElementById('teams-screen');
        const gameBoardScreen = document.getElementById('game-board-screen');
        const resultsScreen = document.getElementById('results-screen');
        const questionModal = document.getElementById('question-modal');
        const passQuestionModal = document.getElementById('pass-question-modal');

        // Кнопки навигации
        document.getElementById('start-game-btn').addEventListener('click', showTeamsScreen);
        document.getElementById('add-team-btn').addEventListener('click', addTeam);
        document.getElementById('start-board-btn').addEventListener('click', showGameBoard);
        document.getElementById('end-game-btn').addEventListener('click', showResults);
        document.getElementById('new-game-btn').addEventListener('click', startNewGame);

        // Кнопки в модальном окне вопроса
        document.getElementById('show-hint-btn').addEventListener('click', showHint);
        document.getElementById('correct-answer-btn').addEventListener('click', handleCorrectAnswer);
        document.getElementById('wrong-answer-btn').addEventListener('click', handleWrongAnswer);
        document.getElementById('pass-question-btn').addEventListener('click', showPassQuestionModal);
        document.getElementById('cancel-pass-btn').addEventListener('click', hidePassQuestionModal);

        // Обработчик поля ввода для добавления команды по Enter
        document.getElementById('team-name').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addTeam();
            }
        });

        // Функция назначения обработчиков на ячейки вопросов
        function assignQuestionCellHandlers() {
            document.querySelectorAll('.question-cell').forEach(cell => {
                cell.onclick = null;
                cell.addEventListener('click', function() {
                    if (!this.classList.contains('disabled')) {
                        const category = parseInt(this.getAttribute('data-category'));
                        const value = parseInt(this.getAttribute('data-value'));
                        const questionData = questions[category].find(q => q.value === value);
                        currentQuestion = {
                            category: category,
                            value: value,
                            originalValue: value,
                            data: questionData,
                            cell: this // сохраняем ссылку на ячейку
                        };
                        showTeamSelectModal();
                        questionsAnswered++;
                        if (questionsAnswered === totalQuestions) {
                            document.getElementById('end-game-btn').classList.add('animate-pulse');
                        }
                    }
                });
            });
        }

        // Функция для отображения экрана добавления команд
        function showTeamsScreen() {
            startScreen.style.display = 'none';
            teamsScreen.style.display = 'block';
        }

        // Функция добавления команды
        function addTeam() {
            const teamNameInput = document.getElementById('team-name');
            const teamName = teamNameInput.value.trim();
            
            if (teamName) {
                const teamId = Date.now();  // Уникальный идентификатор
                const team = {
                    id: teamId,
                    name: teamName,
                    score: 0
                };
                
                teams.push(team);
                
                // Добавление команды в список
                const teamsList = document.getElementById('teams-list');
                const teamItem = document.createElement('li');
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center py-2';
                const span = document.createElement('span');
                span.textContent = teamName;
                const btn = document.createElement('button');
                btn.className = 'text-red-500 hover:text-red-700';
                btn.innerHTML = '<i class="fas fa-trash"></i>';
                btn.addEventListener('click', function() { removeTeam(teamId); });
                div.appendChild(span);
                div.appendChild(btn);
                teamItem.appendChild(div);
                teamsList.appendChild(teamItem);
                
                // Очистка поля ввода
                teamNameInput.value = '';
                
                // Разрешаем начать игру, если есть хотя бы одна команда
                document.getElementById('start-board-btn').disabled = false;
            }
        }

        // Функция удаления команды
        function removeTeam(teamId) {
            teams = teams.filter(team => team.id !== teamId);
            renderTeamsList();
            // Блокируем кнопку начала игры, если нет команд
            document.getElementById('start-board-btn').disabled = teams.length === 0;
        }

        // Перерисовка списка команд
        function renderTeamsList() {
            const teamsList = document.getElementById('teams-list');
            teamsList.innerHTML = '';
            teams.forEach(team => {
                const teamItem = document.createElement('li');
                const div = document.createElement('div');
                div.className = 'flex justify-between items-center py-2';
                const span = document.createElement('span');
                span.textContent = team.name;
                const btn = document.createElement('button');
                btn.className = 'text-red-500 hover:text-red-700';
                btn.innerHTML = '<i class="fas fa-trash"></i>';
                btn.addEventListener('click', function() { removeTeam(team.id); });
                div.appendChild(span);
                div.appendChild(btn);
                teamItem.appendChild(div);
                teamsList.appendChild(teamItem);
            });
        }

        // Функция отображения игрового поля
        function showGameBoard() {
            teamsScreen.style.display = 'none';
            gameBoardScreen.style.display = 'block';
            updateScoreBoard();
            questionsAnswered = 0;
            assignQuestionCellHandlers();
        }

        // Функция обновления табло с баллами
        function updateScoreBoard() {
            const scoreBoard = document.getElementById('score-board');
            scoreBoard.innerHTML = '';
            
            teams.forEach(team => {
                const scoreCard = document.createElement('div');
                scoreCard.className = 'score-card';
                scoreCard.innerHTML = `
                    <h3 class="font-bold">${team.name}</h3>
                    <p class="text-2xl font-bold mt-2">${team.score}</p>
                `;
                scoreBoard.appendChild(scoreCard);
            });
        }

        // Функция для показа модального окна выбора команды
        function showTeamSelectModal() {
            const modal = document.getElementById('team-select-modal');
            const buttonsContainer = document.getElementById('team-select-buttons');
            buttonsContainer.innerHTML = '';
            teams.forEach((team, idx) => {
                const button = document.createElement('button');
                button.className = 'team-select-btn';
                button.textContent = team.name;
                button.onclick = () => selectTeam(idx);
                buttonsContainer.appendChild(button);
            });
            modal.style.display = 'block';
        }

        // Функция для выбора команды
        function selectTeam(idx) {
            currentTeamIndex = idx;
            currentTeam = teams[idx];
            const modal = document.getElementById('team-select-modal');
            modal.style.display = 'none';
            // Передаём ссылку на ячейку вопроса
            openQuestionForTeam(currentQuestion.cell);
        }

        // Функция открытия вопроса для выбранной команды
        function openQuestionForTeam(cell) {
            hintUsed = false;
            const questionData = currentQuestion.data;
            if (cell) currentQuestion.cell = cell;
            document.getElementById('question-category').textContent = getCategoryName(currentQuestion.category);
            document.getElementById('question-value').textContent = `${currentQuestion.value} баллов`;
            document.getElementById('question-text').textContent = questionData.question;
            document.getElementById('current-team-name').textContent = 'Отвечает: ' + currentTeam.name;
            document.getElementById('hint-text').style.display = 'none';
            document.getElementById('hint-text').textContent = '';
            document.getElementById('answer-section').style.display = 'none';
            document.getElementById('answer-text').textContent = '';
            // --- Перемешиваем копию вариантов ответов ---
            const options = questionData.options.map((opt, idx) => ({ text: opt, isCorrect: idx === questionData.correctAnswer }));
            const shuffled = shuffleArrayNew(options);
            const newCorrectIndex = shuffled.findIndex(opt => opt.isCorrect);
            currentQuestion.shuffledOptions = shuffled.map(opt => opt.text);
            currentQuestion.shuffledCorrectAnswer = newCorrectIndex;
            const optionsContainer = document.createElement('div');
            optionsContainer.className = 'options-container mt-6 space-y-3';
            currentQuestion.shuffledOptions.forEach((option, index) => {
                const optionButton = document.createElement('button');
                optionButton.className = 'option-button w-full p-4 text-left rounded-lg transition-all duration-300 hover:bg-blue-50';
                optionButton.style.backgroundColor = '#f8fafc';
                optionButton.style.border = '1px solid #e2e8f0';
                optionButton.textContent = option;
                optionButton.addEventListener('click', () => handleAnswer(index));
                optionsContainer.appendChild(optionButton);
            });
            const oldOptions = document.getElementById('options-placeholder').querySelector('.options-container');
            if (oldOptions) oldOptions.remove();
            document.getElementById('options-placeholder').appendChild(optionsContainer);
            questionModal.style.display = 'block';
        }
        // Новый алгоритм Фишера-Йетса, возвращает новый массив
        function shuffleArrayNew(array) {
            const arr = array.slice();
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // Функция обработки ответа
        function handleAnswer(selectedIndex) {
            const optionButtons = document.querySelectorAll('.option-button');
            // Используем перемешанный индекс правильного ответа
            const correctIndex = currentQuestion.shuffledCorrectAnswer;
            // Отключаем все кнопки
            optionButtons.forEach(button => {
                button.disabled = true;
                button.style.pointerEvents = 'none';
            });
            // Проверяем ответ
            if (selectedIndex === correctIndex) {
                // Правильный ответ
                optionButtons[selectedIndex].style.backgroundColor = '#dcfce7';
                optionButtons[selectedIndex].style.borderColor = '#86efac';
                // Анимация
                const modal = document.querySelector('#question-modal .modal-content');
                modal.classList.add('answer-correct-anim');
                // Начисляем баллы
                const team = teams[currentTeamIndex];
                team.score += currentQuestion.value;
                updateScoreBoard();
                setTimeout(() => {
                    modal.classList.remove('answer-correct-anim');
                    questionModal.style.display = 'none';
                    currentTeam = null;
                }, 1500);
            } else {
                // Неправильный ответ
                optionButtons[selectedIndex].style.backgroundColor = '#fee2e2';
                optionButtons[selectedIndex].style.borderColor = '#fca5a5';
                // Показываем правильный ответ
                optionButtons[correctIndex].style.backgroundColor = '#dcfce7';
                optionButtons[correctIndex].style.borderColor = '#86efac';
                // Анимация
                const modal = document.querySelector('#question-modal .modal-content');
                modal.classList.add('answer-wrong-anim');
                setTimeout(() => {
                    modal.classList.remove('answer-wrong-anim');
                    questionModal.style.display = 'none';
                    currentTeam = null;
                }, 1500);
            }
            // Делаем ячейку вопроса неактивной только после ответа
            if (currentQuestion.cell) {
                currentQuestion.cell.classList.add('disabled');
            }
        }

        // Функция получения названия категории
        function getCategoryName(categoryIndex) {
            const categories = [
                'Гражданский кодекс',
                'Семейный кодекс',
                'Уголовный кодекс',
                'Административный кодекс',
                'Трудовой кодекс'
            ];
            return categories[categoryIndex];
        }

        // Функция показа подсказки
        function showHint() {
            if (!hintUsed) {
                // Уменьшаем стоимость вопроса вдвое
                currentQuestion.value = Math.floor(currentQuestion.value / 2);
                document.getElementById('question-value').textContent = `${currentQuestion.value} баллов (с подсказкой)`;
                hintUsed = true;
            }
            // Показываем подсказку с анимацией
            const hintText = document.getElementById('hint-text');
            hintText.textContent = currentQuestion.data.hint;
            hintText.style.display = 'block';
            hintText.classList.remove('hint-anim');
            // Триггер перерисовки для повторной анимации
            void hintText.offsetWidth;
            hintText.classList.add('hint-anim');
        }

        // Функция обработки правильного ответа
        function handleCorrectAnswer() {
            // Анимация
            const modal = document.querySelector('#question-modal .modal-content');
            modal.classList.add('answer-correct-anim');
            setTimeout(() => { modal.classList.remove('answer-correct-anim'); }, 800);
            // Начисляем баллы команде
            const team = teams[currentTeamIndex];
            team.score += currentQuestion.value;
            updateScoreBoard();
            setTimeout(() => {
                questionModal.style.display = 'none';
                currentTeam = null;
            }, 800);
        }

        // Функция обработки неправильного ответа
        function handleWrongAnswer() {
            // Анимация
            const modal = document.querySelector('#question-modal .modal-content');
            modal.classList.add('answer-wrong-anim');
            setTimeout(() => { modal.classList.remove('answer-wrong-anim'); }, 800);
            setTimeout(() => {
                questionModal.style.display = 'none';
                currentTeam = null;
            }, 800);
        }

        // Функция показа модального окна для передачи вопроса
        function showPassQuestionModal() {
            // Заполняем контейнер с командами
            const passTeamsContainer = document.getElementById('pass-teams-container');
            passTeamsContainer.innerHTML = '';
            
            teams.forEach((team, index) => {
                if (index !== currentTeamIndex) { // Исключаем текущую команду
                    const teamButton = document.createElement('button');
                    teamButton.className = 'team-btn px-4 py-2 bg-blue-500 text-white rounded-full hover:bg-blue-600';
                    teamButton.textContent = team.name;
                    teamButton.addEventListener('click', () => passQuestionToTeam(index));
                    passTeamsContainer.appendChild(teamButton);
                }
            });
            
            // Показываем модальное окно
            passQuestionModal.style.display = 'block';
        }

        // Функция скрытия модального окна передачи вопроса
        function hidePassQuestionModal() {
            passQuestionModal.style.display = 'none';
        }

        // Функция передачи вопроса другой команде
        function passQuestionToTeam(teamIndex) {
            currentTeamIndex = teamIndex;
            currentTeam = teams[teamIndex];
            document.getElementById('current-team-name').textContent = teams[currentTeamIndex].name;
            passQuestionModal.style.display = 'none';
        }

        // Функция показа правильного ответа
        function showAnswer() {
            const btn = document.getElementById('show-answer-btn');
            btn.classList.remove('show-answer-anim');
            void btn.offsetWidth;
            btn.classList.add('show-answer-anim');
            document.getElementById('answer-text').textContent = currentQuestion.data.options[currentQuestion.data.correctAnswer];
            document.getElementById('answer-section').style.display = 'block';
        }

        // Функция отображения результатов
        function showResults() {
            gameBoardScreen.style.display = 'none';
            resultsScreen.style.display = 'block';
            // Сортируем команды по количеству баллов (по убыванию)
            const sortedTeams = [...teams].sort((a, b) => b.score - a.score);
            // Заполняем пьедестал
            document.getElementById('first-place-name').textContent = sortedTeams[0]?.name || '-';
            document.getElementById('first-place-score').textContent = sortedTeams[0]?.score ?? '0';
            document.getElementById('second-place-name').textContent = sortedTeams[1]?.name || '-';
            document.getElementById('second-place-score').textContent = sortedTeams[1]?.score ?? '0';
            document.getElementById('third-place-name').textContent = sortedTeams[2]?.name || '-';
            document.getElementById('third-place-score').textContent = sortedTeams[2]?.score ?? '0';
            // Заполняем полную таблицу результатов
            const resultsTable = document.getElementById('results-table');
            resultsTable.innerHTML = '';
            sortedTeams.forEach((team, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-2">${index + 1}</td>
                    <td class="px-4 py-2">${team.name}</td>
                    <td class="px-4 py-2 text-right">${team.score}</td>
                `;
                resultsTable.appendChild(row);
            });
            // --- Bounce победителя и конфетти ---
            const step1 = document.querySelector('.podium-step-1');
            setTimeout(() => { if (step1) step1.classList.add('animated-winner'); }, 700);
            setTimeout(() => { if (step1) step1.classList.remove('animated-winner'); }, 3600);
            launchConfetti();
        }

        // Конфетти: генерация и запуск
        function launchConfetti() {
            const confettiColors = [
                '#6a82fb', '#fc5c7d', '#43e97b', '#38f9d7', '#a18cd1', '#fbc2eb', '#fad0c4', '#ff61a6', '#ffd700', '#ffe082', '#81c784', '#e57373'
            ];
            const confettiContainer = document.getElementById('confetti');
            confettiContainer.innerHTML = '';
            const confettiCount = 36;
            for (let i = 0; i < confettiCount; i++) {
                const conf = document.createElement('div');
                conf.className = 'confetti';
                conf.style.left = Math.random() * 98 + 'vw';
                conf.style.background = confettiColors[Math.floor(Math.random() * confettiColors.length)];
                conf.style.animationDelay = (Math.random() * 0.8) + 's';
                confettiContainer.appendChild(conf);
            }
            // Удаляем конфетти через 3.5 сек
            setTimeout(() => { confettiContainer.innerHTML = ''; }, 3500);
        }

        // Функция запуска новой игры
        function startNewGame() {
            // Очищаем данные
            teams = [];
            currentQuestion = null;
            currentTeamIndex = 0;
            hintUsed = false;
            questionsAnswered = 0;
            
            // Сбрасываем состояние игровой доски
            document.querySelectorAll('.question-cell').forEach(cell => {
                cell.classList.remove('disabled');
            });
            
            // Возвращаемся на начальный экран
            resultsScreen.style.display = 'none';
            startScreen.style.display = 'block';
            assignQuestionCellHandlers();
        }

        // Назначаем обработчики при первой загрузке страницы
        assignQuestionCellHandlers();
    </script>
</body>
</html>
